@model Stats

<h2>1. THỐNG KÊ DOANH THU</h2>
<form>
    <div class="row">
    
    <div class="col-lg-4">
        <label>Chọn thời gian: </label>
        <input class="form-control" id="time" asp-for="Time" value="@DateTime.Now"/>
    </div>
    <div class="col-lg-4">
        <label>Chọn thống kê theo: </label>
        <select class="form-control" asp-for="Type" id="type">
            <option value ="0">Ngày</option>
            <option value = "1">Tháng</option>
            <option value = "2">Năm</option>
            <option value = "3">Quý</option>
        </select>
    </div>
    <div class="col-lg-4">
        <div id="quy"></div>
    </div>
</div>
</form>

    <div id="piechart" style="width: 900px; height: 500px;"></div>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script type="text/javascript">

    $('#type').change(function(){
        
        //check show Quater I , II, III, VI
        var t = $(this).val();
        //console.log(t);
        if(t==3){

            var string = '<label id="lb">Chọn quý: </label>'
            string += '<select id="quater" class="form-control" asp-for="Quater">';
            string += '<option value="1">Quý I</option>';
            string += '<option value="2">Quý II</option>';
            string += '<option value="3">Quý III</option>';
            string += '<option value="4">Quý IV</option>';
            string += '</select>';
            $('#quy').append(string);
            
        }
        else 
        {
            $('#lb').remove();
            $('#quater').remove();
            
        }

        if(t == 0){
            //Get Ngay
            var time = $('#time').val();
            console.log(t);
            if(time==''){
                alert("Hãy chọn thời gian!");
            }
            else{
                $.get("/dashboard/home/getstatsday?time="+time, function(dulieu, status){
                    console.log(dulieu);
                });
            }
        }
        else if(t == 1){
            var time = $('#time').val();
            console.log(t);
            if(time==''){
                alert("Hãy chọn thời gian!");
            }
            else{
                
                    google.charts.load("current", {packages:["corechart"]});
                    google.charts.setOnLoadCallback(function (){
                        var arr=[['Task', 'Hours per Day']];
                        
                        var chart = new google.visualization.PieChart(document.getElementById('piechart'));

                        $.get("/dashboard/home/getstatsmonth?time="+time, function(dulieu, status){
                                console.log(dulieu);
                                var test = dulieu[0]['categories'];
                                for(var i in test){
                                    arr.push([test[i]['cateName'],test[i]['total']]);
                                } 
                                var options = {
                                      title: dulieu[0]['typeOfTour'],
                                      pieHole: 0.4,
                                };
                                var data = google.visualization.arrayToDataTable(arr);
                                chart.draw(data, options);
                        });
                    
                });
            }
        }
        else if(t == 2){
            var time = $('#time').val();
            console.log(t);
            if(time==''){
                alert("Hãy chọn thời gian!");
            }
            else{
                $.get("/dashboard/home/getstatsyear?time="+time, function(dulieu, status){
                    console.log(dulieu);
                    
                });
            }
        }


    });

</script>
